---
title: "マクロの記録と編集：コードを書かずに自動化を体験しよう"
date: "2024-02-01"
---


# マクロとは？

マクロとは、Excelで行う操作を**自動的に記録・再生**できる機能です。たとえば、特定のセルの色を変更したり、データをコピーしたりする一連の作業を覚えておき、あとでボタンひとつで再実行できます。

VBAの知識がなくても使えるため、「はじめての自動化体験」として最適です。

# マクロを記録する準備

マクロを記録するには、まずExcelで「開発」タブを表示しておく必要があります。

## 開発タブの表示方法（初回のみ）

1. Excel上部のリボンから「ファイル」→「オプション」を選択
2. 「リボンのユーザー設定」をクリック
3. 「開発」にチェックを入れて「OK」

これで、「開発」タブが表示されるようになります。

# マクロを記録してみよう

実際に、簡単なマクロを記録してみましょう。

## 例：セルに色を付けるマクロ

1. 「開発」タブをクリック
2. 「マクロの記録」をクリック
3. マクロ名を入力（例：ColorCell）
4. 「OK」をクリックすると記録開始
5. 任意のセルを選択し、「塗りつぶしの色」で色を指定
6. 「開発」タブ → 「記録終了」をクリック

これで、**今の操作がすべて記録され、マクロとして保存**されました。

# 記録されたマクロの中身を見てみよう

記録されたマクロは、実はVBAコードとして保存されています。

1. 「開発」タブ → 「マクロ」ボタンをクリック
2. マクロ一覧から「ColorCell」を選択 → 「編集」
3. VBAエディタ（VBE）が開き、以下のようなコードが表示されます：

```vba
Sub ColorCell()
    Selection.Interior.Color = RGB(255, 255, 0) ' 黄色に塗りつぶす
End Sub
```

このように、**マクロの記録を通じて、自動的にVBAコードが生成**されるのです。

# マクロの編集をしてみよう

記録されたコードは、あとから自由に編集できます。

## 例1：別の色に変更する

```vba
Selection.Interior.Color = RGB(0, 255, 255) ' 水色に変更
```

## 例2：複数のセルに色を付ける

```vba
Range("A1:A5").Interior.Color = RGB(255, 204, 153)
```

このように、少しずつコードを理解しながら編集することで、**自分専用のマクロを作れるようになります。**

# マクロを実行する

1. 「開発」タブ → 「マクロ」ボタン
2. 実行したいマクロ名を選択
3. 「実行」ボタンをクリック

または、ボタンにマクロを割り当てることで、**ワンクリックで実行**することも可能です。

# まとめ

マクロの記録機能は、VBAの第一歩として非常に有効です。コードを書かずに自動化を体験できるうえ、自動生成されたVBAコードを読むことで、プログラミングへの理解も深まります。

次回は、\*\*「VBAエディタ（VBE）の使い方と基本操作」\*\*を解説します。自動生成されたマクロを、どのように編集・拡張できるのかを学んでいきましょう。
