---
title: "はじめてのVBAコード：メッセージボックスを表示しよう"
date: "2024-04-01"
---
# はじめてのVBAコード

いよいよVBAで実際にコードを書いてみましょう。最初のステップとして、**「メッセージボックス（MsgBox）」を使って文字を表示する**簡単なプログラムを作成します。

# メッセージボックスとは？

メッセージボックスとは、**画面に小さなダイアログを表示してメッセージを伝える**機能です。

例えば、こんな画面が表示されます：

```
こんにちは！
[OK]
```

これをVBAで表示するには、`MsgBox` 関数を使います。

# コードを書いてみよう

まずは、標準モジュールを挿入しましょう。

## 手順

1. Excelで `Alt + F11` を押してVBE（エディタ）を開く
2. メニューバー「挿入」→「標準モジュール」を選択
3. 以下のコードを入力：

```vba
Sub HelloVBA()
    MsgBox "こんにちは！VBAの世界へようこそ"
End Sub
```

このコードを実行すると、メッセージボックスが表示されます。

# コードの解説

```vba
Sub HelloVBA()
```

* `Sub` は「Subプロシージャ（処理のかたまり）」の始まりを示します。
* `HelloVBA` はこの処理に付けた名前（好きな名前に変更可能）

```vba
    MsgBox "こんにちは！VBAの世界へようこそ"
```

* `MsgBox` はメッセージボックスを表示するVBAの命令
* ダブルクォーテーション `""` の中に表示する文字を記述します

```vba
End Sub
```

* Subプロシージャの終わりを表します

# コードを実行してみよう

実行するには、以下のいずれかの方法を使います。

## 方法1：F5キーを使う

1. カーソルをコード内に置いた状態で `F5` を押す

## 方法2：マクロから実行

1. Excelの「開発」タブ → 「マクロ」をクリック
2. 実行したいマクロ（HelloVBA）を選択
3. 「実行」をクリック

# 応用：変数を使ってみよう

次に、メッセージの内容を変数に入れて表示してみましょう。

```vba
Sub GreetUser()
    Dim message As String
    message = "お疲れさまです！"
    MsgBox message
End Sub
```

* `Dim message As String`：文字列型の変数 `message` を宣言
* `message = "..."`：変数に値を代入
* `MsgBox message`：変数に入れた文字列を表示

# まとめ

今回は、VBAで最も簡単な命令の1つである `MsgBox` を使って、メッセージを表示する方法を学びました。

このように、VBAは「書いたコードがすぐに反応する」ため、初心者でも楽しみながら学ぶことができます。

次回は、\*\*「変数とデータ型」\*\*について詳しく見ていきましょう。より複雑な処理を行うための準備です！
