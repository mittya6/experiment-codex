---
title: "変数とデータ型：VBAで情報を扱う基本"
date: "2024-05-01"
---

# 変数とは？

変数とは、**値（データ）を一時的に保存するための入れ物**です。VBAでは、処理の途中で文字列や数値などを一時的に記憶しておくときに変数を使います。

たとえば、名前や合計金額などを一時的に保存し、あとで利用するといった使い方をします。

# 変数を使うメリット

* **コードの可読性が上がる**（意味のある名前をつけられる）
* **再利用しやすい**（値を何度も使える）
* **メンテナンスがしやすい**（値を変えるだけで処理全体に反映）

# 変数の宣言方法

VBAで変数を使うときは、`Dim`（ディム）というキーワードを使って宣言します。

```vba
Dim 変数名 As データ型
```

たとえば：

```vba
Dim userName As String
Dim total As Integer
```

このように書くことで、`userName` という変数には文字列、`total` には整数を入れられるようになります。

# よく使うデータ型

| データ型    | 内容                   | 例            |
| ------- | -------------------- | ------------ |
| String  | 文字列                  | "こんにちは"      |
| Integer | 整数（-32,768〜32,767）   | 100          |
| Long    | より大きな整数              | 100000       |
| Double  | 小数を含む数値              | 3.14         |
| Boolean | 真(True) または 偽(False) | True, False  |
| Date    | 日付や時間                | #2025/07/10# |

# 変数に値を代入する

変数には `=` を使って値を代入します。

```vba
Dim message As String
message = "ようこそVBAへ！"
MsgBox message
```

この例では、`message` という変数に文字列を代入し、それをメッセージボックスで表示しています。

# 複数の変数を使ってみよう

```vba
Sub ShowInfo()
    Dim name As String
    Dim age As Integer

    name = "山田"
    age = 28

    MsgBox name & "さんは" & age & "歳です。"
End Sub
```

* `&` は文字列をつなげる記号（連結演算子）です。

# 変数の注意点

* 変数名は**英数字とアンダースコア**で構成し、**先頭は英字**にする必要があります。
* `Dim` を使わずにいきなり変数を使うこともできますが、ミスに気づきにくくなるため、明示的に宣言する習慣をつけましょう。

## Option Explicitのすすめ

VBEで「ツール」→「オプション」→「変数の宣言を強制する」にチェックを入れると、自動的にコードの先頭に `Option Explicit` が追加され、**すべての変数を宣言しないとエラーになる**ようになります。

これにより、タイポや宣言漏れを防ぐことができます。

# まとめ

VBAにおいて、変数とデータ型の理解はとても重要です。データを一時的に保存・操作できるようになることで、コードの柔軟性と再利用性が高まります。

次回は、\*\*「条件分岐（If, Select Case）」\*\*を使って、処理を分ける方法を学びましょう。
