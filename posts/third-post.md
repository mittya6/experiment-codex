---
title: "VBAエディタ（VBE）の使い方と基本操作"
date: "2024-03-01"
---

# VBAエディタ（VBE）とは？

VBAエディタ（VBE：Visual Basic Editor）は、ExcelのマクロやVBAコードを書くための専用画面です。マクロの記録で自動生成されたコードを確認したり、自分でコードを書いたり、編集・保存・実行などを行うことができます。

VBEを使いこなすことで、VBAの本格的な開発が可能になります。

# VBEの開き方

VBEを開く方法はいくつかあります。

## 方法1：開発タブから開く

1. Excelの「開発」タブをクリック
2. 「Visual Basic」ボタンをクリック

## 方法2：ショートカットキー

* `Alt + F11` を押すと、すぐにVBEが開きます。

# VBEの画面構成

VBEの画面は以下のような構成になっています。

## プロジェクトエクスプローラー

画面左側にあり、現在開いているブックのVBA構成（モジュールやシート、フォームなど）を一覧で確認できます。

* `Sheet1 (Sheet1)`：各ワークシートに対応するコード領域
* `ThisWorkbook`：ブック全体に関わる処理を書く領域
* `Module1`：標準モジュール。マクロや自作関数はここに書くことが多いです

## コードウィンドウ

画面右側に表示されるコード記述エリア。実際にVBAコードを入力・編集する場所です。

## プロパティウィンドウ

選択しているオブジェクトの名前や設定値を確認・変更できます。主にフォームやコントロールを扱うときに使います。

# 標準モジュールを追加する

自分でコードを書くには「標準モジュール」を追加すると便利です。

## 手順

1. メニューバー「挿入」→「標準モジュール」を選択
2. プロジェクトエクスプローラーに「Module1」が追加される
3. コードウィンドウにマクロや関数を記述

## 例

```vba
Sub HelloWorld()
    MsgBox "こんにちは、VBA！"
End Sub
```

このコードを記述したあと、`F5` キーで実行できます。

# コードの実行とデバッグ

VBEでは、コードの実行やエラー調査（デバッグ）も行えます。

## 実行方法

* `F5`：現在のプロシージャを実行
* `F8`：1行ずつステップ実行

## ブレークポイント

コードの左端をクリックすることで、赤い●（ブレークポイント）を設置できます。
コードがそこまで実行されると一時停止し、変数の中身などを確認できます。

# 保存と閉じ方

作成したマクロはExcelファイルと一緒に保存されます。ただし、保存形式に注意が必要です。

## マクロ付きファイルとして保存

* 拡張子が `.xlsm` の形式で保存してください。
* 通常の `.xlsx` 形式では、マクロが保存されません。

# まとめ

VBE（VBAエディタ）は、VBAを本格的に活用するための中心的なツールです。初めは画面構成に戸惑うかもしれませんが、慣れてしまえば非常に強力な開発環境です。

次回は、**「はじめてのVBAコード：メッセージボックスを表示しよう」** を通じて、実際に簡単なコードを書いてみましょう。
